{% load wagtailcore_tags wagtailimages_tags %}

{% comment %}
Related content / content listing component.

Usage:
    {% include "components/related_content/related_content.html" with related_pages=pages %}

Optional parameters:
    - heading: Custom heading text (default: "Also of interest")
    - heading_id: Custom ID for the heading (default: "related-content-heading")
    - intro: Optional intro text below the heading
    - modifier: BEM modifier class (e.g., "archive-highlights", "recently-archived")
    - related_pages: List of page objects to display
{% endcomment %}

{% if related_pages %}
    <div class="related-content{% if modifier %} related-content--{{ modifier }}{% endif %}">
        <div class="related-content__container u-layout">
            <h2 class="related-content__heading{% if intro %} related-content__heading--tight{% endif %} heading heading--two col-span-12" id="{{ heading_id|default:'related-content-heading' }}">
                {{ heading|default:"Also of interest" }}
            </h2>
            {% if intro %}
                <p class="related-content__intro col-span-12">{{ intro }}</p>
            {% endif %}
            <section class="related-content__list col-span-12" aria-labelledby="{{ heading_id|default:'related-content-heading' }}">
                {% for item in related_pages %}
                    {% pageurl item as item_url %}
                    <article class="card card--clickable{% if modifier %} card--{{ modifier }}{% endif %}">
                        {% if item.category %}
                            <span class="card__category supporting">{{ item.category }}</span>
                        {% endif %}
                        <a class="card__link" href="{{ item_url|default:'#' }}">
                            <h3 class="card__heading heading heading--four">{% firstof item.listing_title item.title %}</h3>
                        </a>
                        {% if item.listing_summary or item.introduction %}
                            <p class="card__summary supporting">{% firstof item.listing_summary item.introduction %}</p>
                        {% endif %}
                        {% if item.source_url %}
                            <p class="card__source supporting">{{ item.source_url }}</p>
                        {% endif %}
                    </article>
                {% endfor %}
            </section>
        </div>
    </div>
{% endif %}
